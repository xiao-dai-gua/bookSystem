{"remainingRequest":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\src\\views\\message\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\src\\views\\message\\add.vue","mtime":1631350761430},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge2dldEFkZHJlc3N9IGZyb20gJy4uLy4uL2FwaS9hZGRyZXNzJw0KaW1wb3J0IHsgZ2V0TGV2ZWwgfSBmcm9tICcuLi8uLi9hcGkvbGV2ZWwnDQppbXBvcnQgeyBhZGRNZXNzYWdlLG1lc3NhZ2VpZCwgdXBkYXRlTWVzc2FnZSB9IGZyb20gJy4uLy4uL2FwaS9tZXNzYWdlJw0KICAgIGV4cG9ydCBkZWZhdWx0ew0KICAgICAgICBkYXRhKCl7DQogICAgICAgICAgICByZXR1cm57DQogICAgICAgICAgICAgICAgbWVzc2FnZUZvcm06ew0KICAgICAgICAgICAgICAgICAgICB1bmFtZToiIiwNCiAgICAgICAgICAgICAgICAgICAgdGVsOiIiLA0KICAgICAgICAgICAgICAgICAgICBsZXZlbGlkOiIiLA0KICAgICAgICAgICAgICAgICAgICBhZGRyZXNzaWQ6IiIsDQogICAgICAgICAgICAgICAgICAgIHRjb2luOiIiLA0KICAgICAgICAgICAgICAgICAgICB3ZWl4aW46IiINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGxldmVsTGlzdDpbXSwNCiAgICAgICAgICAgICAgICBhZGRyZXNzOltdLA0KICAgICAgICAgICAgICAgIGZpbGVMaXN0OltdLA0KICAgICAgICAgICAgICAgIHVwZGF0YTpmYWxzZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjcmVhdGVkKCkgew0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcm91dGUucXVlcnkpDQogICAgICAgICAgICBpZih0aGlzLiRyb3V0ZS5xdWVyeS5pZCl7DQogICAgICAgICAgICAgICAgdGhpcy51cGRhdGEgPSB0cnVlLA0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWVzc2FnZWlkKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHJvdXRlLnBhcmFtcykvL+WPr+S7pei+k+WHuumhtemdouS5i+mXtOS8oOmAkueahOWPguaVsA0KICAgICAgICAgICAgdGhpcy5pbml0UGFnZSgpOw0KICAgICAgICAgICAgLy8gdGhpcy5nZXRMZXZlbERhdGEoKQ0KICAgICAgICAgICAgLy8gdGhpcy5nZXRBZGRyZXNzRGF0YSgpDQogICAgICAgIH0sDQogICAgICAgIG1ldGhvZHM6IHsNCiAgICAgICAgICAgIC8v5L+u5pS55L+h5oGvDQogICAgICAgICAgICBVcGRhdGVNZXNzYWdlSGFuZGxlKCl7DQogICAgICAgICAgICAgICAgbGV0IHt1bmFtZSxhZGRyZXNzaWQsbGV2ZWxpZCx0ZWx9ID0gdGhpcy5tZXNzYWdlRm9ybTsNCiAgICAgICAgICAgICAgICB1cGRhdGVNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQ6dGhpcy4kcm91dGUucXVlcnkuaWQsDQogICAgICAgICAgICAgICAgICAgIHVuYW1lLA0KICAgICAgICAgICAgICAgICAgICBhZGRyZXNzaWQsDQogICAgICAgICAgICAgICAgICAgIGxldmVsaWQsDQogICAgICAgICAgICAgICAgICAgIHRlbA0KICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9tZXNzYWdlL2xpc3QnKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLy/moLnmja5JZOiOt+WPluS/oeaBrw0KICAgICAgICAgICAgZ2V0TWVzc2FnZWlkKCl7DQogICAgICAgICAgICAgICAgbWVzc2FnZWlkKHsNCiAgICAgICAgICAgICAgICAgICAgaWQ6dGhpcy4kcm91dGUucXVlcnkuaWQNCiAgICAgICAgICAgICAgICB9KS50aGVuKChyZXMpPT57DQogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUZvcm0gPSB7DQogICAgICAgICAgICAgICAgICAgIGpybmFtZTpyZXMuZGF0YVswXS5qcm5hbWUsDQogICAgICAgICAgICAgICAgICAgIGpydGVsOnJlcy5kYXRhWzBdLmpydGVsLA0KICAgICAgICAgICAgICAgICAgICBsZXZlbGlkOnJlcy5kYXRhWzBdLmpybGV2ZWwsDQogICAgICAgICAgICAgICAgICAgIGFkZHJlc3NpZDpyZXMuZGF0YVswXS5qcmFkZHJlc3Nlc2lkLA0KICAgICAgICAgICAgICAgICAgICB0Y29pbjpyZXMuZGF0YVswXS50Y29pbiwNCiAgICAgICAgICAgICAgICAgICAgd2VpeGluOnJlcy5kYXRhWzBdLndlaXhpbg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvL+a3u+WKoOS/oeaBrw0KICAgICAgICAgICAgYWRkTWVzc2FnZUhhbmRsZShmb3JtTmFtZSl7DQogICAgICAgICAgICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHJlcyk9PnsNCiAgICAgICAgICAgICAgICAgICAgaWYocmVzKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE1lc3NhZ2Uoey4uLnRoaXMubWVzc2FnZUZvcm19KS50aGVuKChyZXMpPT57DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLy/ojrflj5bnrYnnuqfliJfooagNCiAgICAgICAgICAgIGdldExldmVsRGF0YSgpew0KICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpPT57DQogICAgICAgICAgICAgICAgICAgIGdldExldmVsKCkudGhlbigocmVzKT0+ew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxldmVsTGlzdCA9IHJlcy5kYXRhDQogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsvL+aIkOWKn+S5i+WQjuiuqeWFtui/kOihjA0KDQp9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIC8v6I635Y+W5Zyw5Z2ADQogICAgICAgICAgICBnZXRBZGRyZXNzRGF0YSgpew0KICAgICAgICAgICAgICAgIHJldHVybiBuZXcgIFByb21pc2UoKHJlc29sdmUscmVqZWN0KT0+ew0KICAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzcygpLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRyZXNzID0gcmVzLmRhdGEsDQogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLy/lpLTlg4/kuIrkvKDmiJDlip8NCiAgICAgICAgICAgIGhlYWRVcGxvYWQocmVzLGZpbGUsZmlsZXMpew0KICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUZvcm0udGNvaW4gPSByZXMuaGVhZGVydXJsOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAvL+W+ruS/oeS6jOe7tOeggeS4iuS8oOaIkOWKnw0KICAgICAgICAgICB3eFVwbG9hZChyZXMpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VGb3JtLndlaXhpbiA9IHJlcy53ZWl4aW51cmw7DQogICAgfSwNCiAgICAgICAgIC8v5Yid5aeL5YyW6aG16Z2iDQogICAgICAgICAgICBpbml0UGFnZSgpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5byA5aeL5Yqg6L296aG16Z2iIikNCiAgICAgICAgICAgICAgICBsZXQgYWRkcmVzc1Byb21pc2UgPSB0aGlzLmdldEFkZHJlc3NEYXRhKCkNCiAgICAgICAgICAgICAgICBsZXQgbGV2ZWxQcm9taXNlID0gdGhpcy5nZXRMZXZlbERhdGEoKQ0KICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKFtsZXZlbFByb21pc2UsYWRkcmVzc1Byb21pc2VdKS50aGVuKCgpPT57DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLnu5PmnZ/liqDovb3pobXpnaIiKQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICANCg0KICAgIH0NCg=="},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA","file":"add.vue","sourceRoot":"src/views/message","sourcesContent":["<template>\r\n    <div class=\"box\">\r\n       <el-row :gutter=\"20\">\r\n        <el-col :span=\"6\" >\r\n            <!--这个model和下面的结合形成data里的数据模式-->\r\n            <el-form :model=\"messageForm\" ref=\"messageForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n            <el-form-item\r\n                label=\"姓名\"\r\n                prop=\"uname\"\r\n                :rules=\"[\r\n                { required: true, message: '请填写姓名'},\r\n                ]\"\r\n            >\r\n                <el-input  v-model=\"messageForm.uname\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item\r\n                label=\"电话\"\r\n                prop=\"tel\"\r\n                :rules=\"[\r\n                { required: true, message: '请填写电话'},\r\n                ]\"\r\n            >\r\n                <el-input  v-model=\"messageForm.tel\"></el-input>\r\n            </el-form-item>\r\n            <!--地址选择-->\r\n            <el-form-item label=\"选择地址\">\r\n                <el-select v-model=\"messageForm.addressid\" placeholder=\"请选择地址\">\r\n                    <!--加上冒号是v-bind的简写绑定属性-->\r\n                <el-option v-for=\"item in address\" :key=\"item.addressid\" :label=\"item.addressname\" :value=\"item.addressid\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <!--等级-->\r\n            <el-form-item label=\"选择等级\">\r\n                <el-select v-model=\"messageForm.levelid\" placeholder=\"请选择等级\"><!--:表示不让他按字符串处理-->\r\n                <el-option v-for=\"item in levelList\" :key=\"item.jrid\" :label=\"item.levelname\" :value=\"item.jrid\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n             <!--上传头像-->\r\n            <el-form-item label=\"上传头像\">\r\n                <el-upload\r\n                    class=\"upload-demo\"\r\n                    action=\"http://47.92.82.13:4000/getMessageA\"\r\n                    :file-list=\"fileList\"\r\n                    name=\"sfile\"\r\n                    :on-success=\"headUpload\"\r\n                    ><!--更改文件名字-->\r\n                    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                    <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n            </el-form-item>\r\n            <el-form-item label=\"上传二维码\">\r\n                <el-upload\r\n                    class=\"upload-demo\"\r\n                    action=\"http://47.92.82.13:4000/getMessageB\"\r\n                    :file-list=\"fileList\"\r\n                    name = \"sweixin\"\r\n                    :on-success=\"wxUpload\"\r\n                    >\r\n                    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                    <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button v-if=\"updata\" type=\"primary\" @click=\"UpdateMessageHandle('messageForm')\">修改</el-button>\r\n                <el-button v-else type=\"primary\" @click=\"addMessageHandle('messageForm')\">提交</el-button>\r\n                <el-button @click=\"resetForm('messageForm')\">重置</el-button>\r\n            </el-form-item>\r\n            </el-form>\r\n        </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\nimport {getAddress} from '../../api/address'\r\nimport { getLevel } from '../../api/level'\r\nimport { addMessage,messageid, updateMessage } from '../../api/message'\r\n    export default{\r\n        data(){\r\n            return{\r\n                messageForm:{\r\n                    uname:\"\",\r\n                    tel:\"\",\r\n                    levelid:\"\",\r\n                    addressid:\"\",\r\n                    tcoin:\"\",\r\n                    weixin:\"\"\r\n                },\r\n                levelList:[],\r\n                address:[],\r\n                fileList:[],\r\n                updata:false\r\n            }\r\n        },\r\n        created() {\r\n            // console.log(this.$route.query)\r\n            if(this.$route.query.id){\r\n                this.updata = true,\r\n                this.getMessageid()\r\n            }\r\n            // console.log(this.$route.params)//可以输出页面之间传递的参数\r\n            this.initPage();\r\n            // this.getLevelData()\r\n            // this.getAddressData()\r\n        },\r\n        methods: {\r\n            //修改信息\r\n            UpdateMessageHandle(){\r\n                let {uname,addressid,levelid,tel} = this.messageForm;\r\n                updateMessage({\r\n                    id:this.$route.query.id,\r\n                    uname,\r\n                    addressid,\r\n                    levelid,\r\n                    tel\r\n                }).then((res)=>{\r\n                    console.log(res);\r\n                    this.$router.push('/message/list')\r\n                })\r\n            },\r\n            //根据Id获取信息\r\n            getMessageid(){\r\n                messageid({\r\n                    id:this.$route.query.id\r\n                }).then((res)=>{\r\n                    this.messageForm = {\r\n                    jrname:res.data[0].jrname,\r\n                    jrtel:res.data[0].jrtel,\r\n                    levelid:res.data[0].jrlevel,\r\n                    addressid:res.data[0].jraddressesid,\r\n                    tcoin:res.data[0].tcoin,\r\n                    weixin:res.data[0].weixin\r\n                    }\r\n                })\r\n            },\r\n            //添加信息\r\n            addMessageHandle(formName){\r\n                this.$refs[formName].validate((res)=>{\r\n                    if(res){\r\n                        addMessage({...this.messageForm}).then((res)=>{\r\n                            console.log(res)\r\n                        })\r\n                    }\r\n                })\r\n            },\r\n            //获取等级列表\r\n            getLevelData(){\r\n                return new Promise((resolve,reject)=>{\r\n                    getLevel().then((res)=>{\r\n                    this.levelList = res.data\r\n                    resolve();//成功之后让其运行\r\n\r\n})\r\n                    })\r\n            },\r\n            //获取地址\r\n            getAddressData(){\r\n                return new  Promise((resolve,reject)=>{\r\n                     getAddress().then((res)=>{\r\n                    this.address = res.data,\r\n                    resolve();\r\n                })\r\n                })\r\n            },\r\n            //头像上传成功\r\n            headUpload(res,file,files){\r\n                this.messageForm.tcoin = res.headerurl;\r\n            },\r\n             //微信二维码上传成功\r\n           wxUpload(res) {\r\n                this.messageForm.weixin = res.weixinurl;\r\n    },\r\n         //初始化页面\r\n            initPage() {\r\n                console.log(\"开始加载页面\")\r\n                let addressPromise = this.getAddressData()\r\n                let levelPromise = this.getLevelData()\r\n                Promise.all([levelPromise,addressPromise]).then(()=>{\r\n                    console.log(\"结束加载页面\")\r\n                });\r\n            },\r\n        },\r\n       \r\n\r\n    }\r\n</script>\r\n<style>\r\n    .box{\r\n        margin-left: 100px;\r\n        margin-top:100px;\r\n\r\n    }\r\n</style>"]}]}