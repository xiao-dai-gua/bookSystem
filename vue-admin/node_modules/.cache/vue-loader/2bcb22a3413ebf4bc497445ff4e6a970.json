{"remainingRequest":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\src\\views\\message\\add.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\src\\views\\message\\add.vue","mtime":1631350761430},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小林\\Desktop\\前端学习\\vuecli\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJveHsKICAgIG1hcmdpbi1sZWZ0OiAxMDBweDsKICAgIG1hcmdpbi10b3A6MTAwcHg7Cgp9Cg=="},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0LA;AACA;AACA;;AAEA","file":"add.vue","sourceRoot":"src/views/message","sourcesContent":["<template>\r\n    <div class=\"box\">\r\n       <el-row :gutter=\"20\">\r\n        <el-col :span=\"6\" >\r\n            <!--这个model和下面的结合形成data里的数据模式-->\r\n            <el-form :model=\"messageForm\" ref=\"messageForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n            <el-form-item\r\n                label=\"姓名\"\r\n                prop=\"uname\"\r\n                :rules=\"[\r\n                { required: true, message: '请填写姓名'},\r\n                ]\"\r\n            >\r\n                <el-input  v-model=\"messageForm.uname\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item\r\n                label=\"电话\"\r\n                prop=\"tel\"\r\n                :rules=\"[\r\n                { required: true, message: '请填写电话'},\r\n                ]\"\r\n            >\r\n                <el-input  v-model=\"messageForm.tel\"></el-input>\r\n            </el-form-item>\r\n            <!--地址选择-->\r\n            <el-form-item label=\"选择地址\">\r\n                <el-select v-model=\"messageForm.addressid\" placeholder=\"请选择地址\">\r\n                    <!--加上冒号是v-bind的简写绑定属性-->\r\n                <el-option v-for=\"item in address\" :key=\"item.addressid\" :label=\"item.addressname\" :value=\"item.addressid\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <!--等级-->\r\n            <el-form-item label=\"选择等级\">\r\n                <el-select v-model=\"messageForm.levelid\" placeholder=\"请选择等级\"><!--:表示不让他按字符串处理-->\r\n                <el-option v-for=\"item in levelList\" :key=\"item.jrid\" :label=\"item.levelname\" :value=\"item.jrid\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n             <!--上传头像-->\r\n            <el-form-item label=\"上传头像\">\r\n                <el-upload\r\n                    class=\"upload-demo\"\r\n                    action=\"http://47.92.82.13:4000/getMessageA\"\r\n                    :file-list=\"fileList\"\r\n                    name=\"sfile\"\r\n                    :on-success=\"headUpload\"\r\n                    ><!--更改文件名字-->\r\n                    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                    <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n            </el-form-item>\r\n            <el-form-item label=\"上传二维码\">\r\n                <el-upload\r\n                    class=\"upload-demo\"\r\n                    action=\"http://47.92.82.13:4000/getMessageB\"\r\n                    :file-list=\"fileList\"\r\n                    name = \"sweixin\"\r\n                    :on-success=\"wxUpload\"\r\n                    >\r\n                    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                    <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button v-if=\"updata\" type=\"primary\" @click=\"UpdateMessageHandle('messageForm')\">修改</el-button>\r\n                <el-button v-else type=\"primary\" @click=\"addMessageHandle('messageForm')\">提交</el-button>\r\n                <el-button @click=\"resetForm('messageForm')\">重置</el-button>\r\n            </el-form-item>\r\n            </el-form>\r\n        </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\nimport {getAddress} from '../../api/address'\r\nimport { getLevel } from '../../api/level'\r\nimport { addMessage,messageid, updateMessage } from '../../api/message'\r\n    export default{\r\n        data(){\r\n            return{\r\n                messageForm:{\r\n                    uname:\"\",\r\n                    tel:\"\",\r\n                    levelid:\"\",\r\n                    addressid:\"\",\r\n                    tcoin:\"\",\r\n                    weixin:\"\"\r\n                },\r\n                levelList:[],\r\n                address:[],\r\n                fileList:[],\r\n                updata:false\r\n            }\r\n        },\r\n        created() {\r\n            // console.log(this.$route.query)\r\n            if(this.$route.query.id){\r\n                this.updata = true,\r\n                this.getMessageid()\r\n            }\r\n            // console.log(this.$route.params)//可以输出页面之间传递的参数\r\n            this.initPage();\r\n            // this.getLevelData()\r\n            // this.getAddressData()\r\n        },\r\n        methods: {\r\n            //修改信息\r\n            UpdateMessageHandle(){\r\n                let {uname,addressid,levelid,tel} = this.messageForm;\r\n                updateMessage({\r\n                    id:this.$route.query.id,\r\n                    uname,\r\n                    addressid,\r\n                    levelid,\r\n                    tel\r\n                }).then((res)=>{\r\n                    console.log(res);\r\n                    this.$router.push('/message/list')\r\n                })\r\n            },\r\n            //根据Id获取信息\r\n            getMessageid(){\r\n                messageid({\r\n                    id:this.$route.query.id\r\n                }).then((res)=>{\r\n                    this.messageForm = {\r\n                    jrname:res.data[0].jrname,\r\n                    jrtel:res.data[0].jrtel,\r\n                    levelid:res.data[0].jrlevel,\r\n                    addressid:res.data[0].jraddressesid,\r\n                    tcoin:res.data[0].tcoin,\r\n                    weixin:res.data[0].weixin\r\n                    }\r\n                })\r\n            },\r\n            //添加信息\r\n            addMessageHandle(formName){\r\n                this.$refs[formName].validate((res)=>{\r\n                    if(res){\r\n                        addMessage({...this.messageForm}).then((res)=>{\r\n                            console.log(res)\r\n                        })\r\n                    }\r\n                })\r\n            },\r\n            //获取等级列表\r\n            getLevelData(){\r\n                return new Promise((resolve,reject)=>{\r\n                    getLevel().then((res)=>{\r\n                    this.levelList = res.data\r\n                    resolve();//成功之后让其运行\r\n\r\n})\r\n                    })\r\n            },\r\n            //获取地址\r\n            getAddressData(){\r\n                return new  Promise((resolve,reject)=>{\r\n                     getAddress().then((res)=>{\r\n                    this.address = res.data,\r\n                    resolve();\r\n                })\r\n                })\r\n            },\r\n            //头像上传成功\r\n            headUpload(res,file,files){\r\n                this.messageForm.tcoin = res.headerurl;\r\n            },\r\n             //微信二维码上传成功\r\n           wxUpload(res) {\r\n                this.messageForm.weixin = res.weixinurl;\r\n    },\r\n         //初始化页面\r\n            initPage() {\r\n                console.log(\"开始加载页面\")\r\n                let addressPromise = this.getAddressData()\r\n                let levelPromise = this.getLevelData()\r\n                Promise.all([levelPromise,addressPromise]).then(()=>{\r\n                    console.log(\"结束加载页面\")\r\n                });\r\n            },\r\n        },\r\n       \r\n\r\n    }\r\n</script>\r\n<style>\r\n    .box{\r\n        margin-left: 100px;\r\n        margin-top:100px;\r\n\r\n    }\r\n</style>"]}]}